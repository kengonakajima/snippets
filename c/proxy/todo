* とりあえず、webブラウザがゆったことをそのままサーバに通すものをつくってみる。
そのときに、ラッパーをとおすこととする。
ラッパーは

linux.c

にかき、からっぽのproxyの部分は proxy.c
にかく。

じつはこれ,squidたいぷの、シングルプロセスのかるーい
さーばーコードをかくSDKみたいなかんじだな。



さて、 だいたいねっとわーくのばっふぁーはできたので、
こんどは、proxyするところをつくるひつようがある。

そのためにはまず ホスト名とポート ( URL から本来はとってくる)
から、クライアントソケットをつくって、コネクトする必要がある。
それには別の Conをつかうが、そのConと、もとのやつをむすびつけて
おく必要がある。それには ID をつかって検索するのが簡単なので
そうしよう。 socket してあたらしく つくったり、 acceptして
あたらしいソケットができたりしたときに IDを1づつましていく。
そのIDでむすびつける。


browser -> proxy -> server


* lex が以外につかいにくいので直接コードかこうとおもいました。



* まず、ブラウザからの要求をそのまま返すものをつくろう。



* ブラウザからの要求がひととおり終了したら、
つまり、 GET の場合はヘッダの部分がおわったら、 POSTの場合は
Lengthの分だけボディを読みこんだら、サーバにコネクトをはじめる。
ブラウザとのあいだはローカルなので高速だから、それでよい。


* ftp の proxy もさぽーとするんだったら、ポートかえたほうがいいね。


