#include <stdio.h>
#include "udpc.h"



int main()
{
	int vfd;
	
	UDPCInit(9002);

	vfd = UDPCConnect( inet_addr( "192.168.1.61" ) ,htons( 9001 ) );

	fprintf( stderr, "connect return:%d\n" , vfd );
	if(1){
		char data[] = 
		"A000111122223333444455556666777788889999"
		"B000111122223333444455556666777788889999"
		"C000111122223333444455556666777788889999"
		"D000111122223333444455556666777788889999"
		"E000111122223333444455556666777788889999"
		"F000111122223333444455556666777788889999"
		"G000111122223333444455556666777788889999"
		"H000111122223333444455556666777788889999"
		"I000111122223333444455556666777788889999"
		"J000111122223333444455556666777788889999"
		"K000111122223333444455556666777788889999"
		"L000111122223333444455556666777788889999"
		"M000111122223333444455556666777788889999";
		/*
		"N000111122223333444455556666777788889999"
		"O000111122223333444455556666777788889999"
		"P000111122223333444455556666777788889999"
		"Q000111122223333444455556666777788889999"
		"R000111122223333444455556666777788889999"
		"S000111122223333444455556666777788889999"
		"T000111122223333444455556666777788889999"
		"U000111122223333444455556666777788889999"
		"V000111122223333444455556666777788889999"
		"W000111122223333444455556666777788889999"
		"X000111122223333444455556666777788889999"
		"Y000111122223333444455556666777788889999"
		"Z000111122223333444455556666777788889999"
		"a000111122223333444455556666777788889999"
		"b000111122223333444455556666777788889999"
		"c000111122223333444455556666777788889999"
		"d000111122223333444455556666777788889999"
		"e000111122223333444455556666777788889999"
		"f000111122223333444455556666777788889999"
		"g000111122223333444455556666777788889999"
		"h000111122223333444455556666777788889999";*/
		
		UDPCWrite( vfd , data , strlen(data) );
	}
/*	UDPCWrite( vfd , "hoge" , 4 );*/

	while(1){
		int n;
		char buf[10000];
		bzero( buf , sizeof( buf ));
		
		UDPC();
		n = UDPCRead( vfd , buf , sizeof(buf));
		if( n > 0 ){
			fprintf( stderr , "%d Byte read:[%s]\n",n ,buf);
			UDPCClose(vfd);
		}
	}
}
